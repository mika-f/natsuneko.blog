---
title: System.CommandLine で引数に応じて動的にパラメータを生み出したい
date: 2023/11/21
basename: 2023/11/21/add-new-parameter-dynamically-in-system-command-line
categories: ["C#"]
---

[`System.CommandLine`](https://learn.microsoft.com/en-us/dotnet/standard/commandline/get-started-tutorial) で動的にパラメータを追加したいかもしれないケースについて。  
例えば、プラグインシステムに対応していて、 `--plugins ./plugins` としてその先の DLL によってパラメータが追加される場合などが考えられる。  
そういうときの実装方法。

まず、ルートとなるコマンドに `TreatUnmatchedTokensAsErrors = false` として設定する。  
これは、コマンド実行時点で存在しないパラメータが与えられた場合、エラーがでるようにする仕組みだけど、動的に読み込まれるパラメータは別のパラメータに依存しているので、実行時点では定義されていないため。

```csharp:Program.cs
var app = new RootCommand() { TreatUnmatchedTokensAsErrors = false };
```
